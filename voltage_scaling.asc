Version 4
SHEET 1 4616 1844
WIRE 2272 -1392 2208 -1392
WIRE 2656 -1392 2528 -1392
WIRE 2720 -1392 2656 -1392
WIRE 3104 -1392 2976 -1392
WIRE 3168 -1392 3104 -1392
WIRE 3472 -1392 3424 -1392
WIRE 1744 -1376 1712 -1376
WIRE 1776 -1376 1744 -1376
WIRE 1920 -1376 1888 -1376
WIRE 2208 -1376 2208 -1392
WIRE 2656 -1376 2656 -1392
WIRE 3104 -1376 3104 -1392
WIRE 1920 -1344 1888 -1344
WIRE 1920 -1312 1888 -1312
WIRE 2208 -1280 2208 -1296
WIRE 2272 -1280 2208 -1280
WIRE 2656 -1280 2656 -1296
WIRE 2656 -1280 2528 -1280
WIRE 2720 -1280 2656 -1280
WIRE 3104 -1280 3104 -1296
WIRE 3104 -1280 2976 -1280
WIRE 3168 -1280 3104 -1280
WIRE 3536 -1280 3424 -1280
WIRE 3616 -1280 3536 -1280
WIRE 3744 -1280 3696 -1280
WIRE 2208 -1248 2208 -1280
WIRE 2352 -1216 2352 -1248
WIRE 2400 -1216 2400 -1248
WIRE 2448 -1216 2448 -1248
WIRE 2800 -1216 2800 -1248
WIRE 2848 -1216 2848 -1248
WIRE 2896 -1216 2896 -1248
WIRE 3248 -1216 3248 -1248
WIRE 3296 -1216 3296 -1248
WIRE 3344 -1216 3344 -1248
WIRE 1776 -1088 1744 -1088
WIRE 1920 -1088 1888 -1088
WIRE 2272 -1072 2224 -1072
WIRE 2656 -1072 2528 -1072
WIRE 2720 -1072 2656 -1072
WIRE 3104 -1072 2976 -1072
WIRE 3168 -1072 3104 -1072
WIRE 3472 -1072 3424 -1072
WIRE 1920 -1056 1888 -1056
WIRE 2224 -1056 2224 -1072
WIRE 2656 -1056 2656 -1072
WIRE 3104 -1056 3104 -1072
WIRE 1920 -1024 1888 -1024
WIRE 2224 -960 2224 -976
WIRE 2272 -960 2224 -960
WIRE 2656 -960 2656 -976
WIRE 2656 -960 2528 -960
WIRE 2720 -960 2656 -960
WIRE 3104 -960 3104 -976
WIRE 3104 -960 2976 -960
WIRE 3168 -960 3104 -960
WIRE 3536 -960 3424 -960
WIRE 3616 -960 3536 -960
WIRE 3744 -960 3696 -960
WIRE 1776 -944 1744 -944
WIRE 1920 -944 1888 -944
WIRE 2224 -928 2224 -960
WIRE 1920 -912 1888 -912
WIRE 2352 -896 2352 -928
WIRE 2400 -896 2400 -928
WIRE 2448 -896 2448 -928
WIRE 2800 -896 2800 -928
WIRE 2848 -896 2848 -928
WIRE 2896 -896 2896 -928
WIRE 3248 -896 3248 -928
WIRE 3296 -896 3296 -928
WIRE 3344 -896 3344 -928
WIRE 1920 -880 1888 -880
WIRE 1776 -800 1744 -800
WIRE 1920 -800 1888 -800
WIRE 1920 -768 1888 -768
WIRE 1920 -736 1888 -736
FLAG 2352 -1216 DPA
FLAG 2400 -1216 D0A
FLAG 2448 -1216 DNA
FLAG 2208 -1248 0
FLAG 1920 -1376 DPA
FLAG 1920 -1344 D0A
FLAG 1920 -1312 DNA
FLAG 1712 -1216 0
FLAG 1744 -1376 DA
FLAG 1920 -1088 SPA
FLAG 1920 -1056 S0A
FLAG 1920 -1024 SNA
FLAG 1744 -1088 DA
FLAG 3744 -960 0
FLAG 3536 -960 OUT
FLAG 2352 -896 SPA
FLAG 2400 -896 S0A
FLAG 2448 -896 SNA
FLAG 2224 -928 0
FLAG 3744 -1280 0
FLAG 3536 -1280 OUTavg
FLAG 1920 -944 SPB
FLAG 1920 -912 S0B
FLAG 1920 -880 SNB
FLAG 1744 -944 DA
FLAG 1920 -800 SPC
FLAG 1920 -768 S0C
FLAG 1920 -736 SNC
FLAG 1744 -800 DA
FLAG 2800 -896 SPB
FLAG 2848 -896 S0B
FLAG 2896 -896 SNB
FLAG 3248 -896 SPC
FLAG 3296 -896 S0C
FLAG 3344 -896 SNC
FLAG 2800 -1216 DPA
FLAG 2848 -1216 D0A
FLAG 2896 -1216 DNA
FLAG 3248 -1216 DPA
FLAG 3296 -1216 D0A
FLAG 3344 -1216 DNA
SYMBOL bv 2208 -1392 M0
SYMATTR InstName Vgavg
SYMATTR Value V={Vdc}
SYMBOL PN_average_model 2400 -1344 R0
SYMATTR InstName XA1
SYMATTR SpiceLine C={C} RP={RP} R0H={R0H} R0L={R0L} RN={RN}
SYMBOL voltage 1712 -1392 M0
WINDOW 0 24 16 Invisible 2
WINDOW 3 39 54 Left 2
SYMATTR InstName V1
SYMATTR Value SINE(0 {ma*0+0.707} {f1} 0 0 180)
SYMBOL voltage 1712 -1312 M0
WINDOW 0 24 16 Invisible 2
WINDOW 3 39 53 Left 2
SYMATTR InstName V7
SYMATTR Value SINE(0 {0*ma/6} {3*f1} 0 0 180)
SYMBOL PN_average_modulator 1824 -1344 R0
WINDOW 0 8 -56 Invisible 2
SYMATTR InstName X2
SYMBOL current 3616 -960 M90
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 52 -137 VRight 2
WINDOW 0 -54 13 VRight 2
SYMATTR Value SINE(0 {16*sqrt(2)} 50 0 0 170)
SYMATTR InstName ILoad
SYMBOL PN_switching_model 2400 -1024 R0
SYMATTR InstName XB1
SYMATTR SpiceLine C=3*100u Rswitch=Rsw
SYMBOL bv 2224 -1072 M0
SYMATTR InstName Vg
SYMATTR Value V={Vdc}
SYMBOL current 3616 -1280 M90
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 52 -137 VRight 2
WINDOW 0 -53 -4 VRight 2
SYMATTR Value SINE(0 {16*sqrt(2)} 50 0 0 170)
SYMATTR InstName ILoadavg
SYMBOL PN_modulator 1824 -1056 R0
WINDOW 0 8 -56 Invisible 2
SYMATTR InstName X1
SYMATTR SpiceLine Ts = {Ts} iCell=1 nCell=3
SYMBOL PN_modulator 1824 -912 R0
WINDOW 0 8 -56 Invisible 2
SYMATTR InstName X3
SYMATTR SpiceLine Ts = {Ts} iCell=2 nCell=3
SYMBOL PN_modulator 1824 -768 R0
WINDOW 0 8 -56 Invisible 2
SYMATTR InstName X4
SYMATTR SpiceLine Ts = {Ts} iCell=3 nCell=3
SYMBOL PN_switching_model 2848 -1024 R0
SYMATTR InstName XB2
SYMATTR SpiceLine C=2*100u Rswitch=Rsw
SYMBOL PN_switching_model 3296 -1024 R0
SYMATTR InstName XB3
SYMATTR SpiceLine C=100u Rswitch=Rsw
SYMBOL PN_average_model 2848 -1344 R0
SYMATTR InstName XA2
SYMATTR SpiceLine C={C} RP={RP} R0H={R0H} R0L={R0L} RN={RN}
SYMBOL PN_average_model 3296 -1344 R0
SYMATTR InstName XA3
SYMATTR SpiceLine C={C} RP={RP} R0H={R0H} R0L={R0L} RN={RN}
SYMBOL bv 2656 -1392 M0
SYMATTR InstName Vgavg1
SYMATTR Value V={Vdc}
SYMBOL bv 3104 -1392 M0
SYMATTR InstName Vgavg2
SYMATTR Value V={Vdc}
SYMBOL bv 2656 -1072 M0
SYMATTR InstName Vg1
SYMATTR Value V={Vdc}
SYMBOL bv 3104 -1072 M0
SYMATTR InstName Vg2
SYMATTR Value V={Vdc}
TEXT 3864 -1304 Left 2 !.param Ts=50us
TEXT 3864 -1400 Left 2 !.tran 0 80m 40m
TEXT 3864 -1328 Left 2 !.param Vdc=400
TEXT 3784 -1088 Left 2 !.param ma=0.62*k f1=50 k=2/sqrt(3)
TEXT 3864 -1232 Left 2 !.param Rsw=100m
TEXT 3864 -1208 Left 2 !.param RP=2*Rsw
TEXT 3864 -1136 Left 2 !.param RN=2*Rsw
TEXT 3864 -1184 Left 2 !.param R0H=2*Rsw
TEXT 3864 -1160 Left 2 !.param R0L=Rsw
TEXT 3864 -1280 Left 2 !.param C=100u
TEXT 3864 -1376 Left 2 !.options reltol=1e-9
