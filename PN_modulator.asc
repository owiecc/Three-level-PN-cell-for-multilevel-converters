Version 4
SHEET 1 1100 680
WIRE 304 160 272 160
WIRE 816 240 720 240
WIRE 992 240 896 240
WIRE -80 272 -80 224
WIRE -176 368 -176 320
WIRE 816 368 720 368
WIRE 992 368 896 368
WIRE -80 384 -80 352
WIRE -176 480 -176 448
WIRE 816 496 720 496
WIRE 992 496 896 496
FLAG -176 480 0
FLAG -176 320 t_neg
FLAG -80 384 0
FLAG -80 224 t_pos
FLAG 720 240 0
FLAG 720 368 0
FLAG 720 496 0
FLAG 992 240 SP
IOPIN 992 240 Out
FLAG 992 368 S0
IOPIN 992 368 Out
FLAG 992 496 SN
IOPIN 992 496 Out
FLAG 272 160 ref
IOPIN 272 160 In
SYMBOL voltage -176 352 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value PULSE(0 -1 {(icell-1)/ncell*Ts} {Ts/2} {Ts/2} 0 {Ts})
SYMBOL voltage -80 256 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value PULSE(1 0 {(icell-1)/ncell*Ts} {Ts/2} {Ts/2} 0 {Ts})
SYMBOL bv 912 240 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Bpos
SYMATTR Value V=  v(ref) >= v(t_pos)
SYMBOL bv 912 368 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Bzero
SYMATTR Value V=  v(ref)<v(t_pos) & v(ref) > v(t_neg)
SYMBOL bv 912 496 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Bneg1
SYMATTR Value V=  v(ref) <= v(t_neg)
