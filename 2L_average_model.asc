Version 4
SHEET 1 2060 780
WIRE -512 16 -608 16
WIRE -512 96 -512 16
WIRE 96 112 96 96
WIRE -64 144 -80 144
WIRE 96 208 96 192
WIRE -512 256 -512 176
WIRE -480 256 -512 256
WIRE -512 336 -512 256
WIRE -512 496 -512 416
WIRE -512 496 -608 496
WIRE -240 496 -512 496
WIRE -80 496 -160 496
WIRE 80 496 0 496
WIRE -512 560 -512 496
WIRE -512 704 -512 640
FLAG 80 496 O
IOPIN 80 496 BiDir
FLAG -608 16 A
IOPIN -608 16 BiDir
FLAG -608 496 B
IOPIN -608 496 BiDir
FLAG -80 144 D
IOPIN -80 144 In
FLAG -480 256 0
FLAG -512 704 0
FLAG 96 208 0
FLAG 96 96 D1
SYMBOL bv -144 496 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName VOB
SYMATTR Value V=V(D1)*V(A,B)
SYMBOL bi -512 96 R0
SYMATTR InstName IA
SYMATTR Value I=V(D1)*I(VIO)
SYMBOL bi -512 416 M180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName IB
SYMATTR Value I=(1-V(D1))*I(VIO)
SYMBOL voltage -96 496 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
SYMATTR InstName VIO
SYMATTR Value 0
SYMBOL bi -512 560 R0
SYMATTR InstName IBx
SYMATTR Value I=I(VOB)
SYMBOL bv 96 96 R0
WINDOW 0 24 16 Invisible 2
SYMATTR InstName VD
SYMATTR Value V=V(D)/2+0.5
TEXT -184 624 Left 2 ;IA, IB and VOB follow converter average equations\nIBx compensates VLB current so it is not added to IB port\nVIO is a sensor for IO current
